<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZEDR17_PRACTICE006</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEDR17_PRACTICE006</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Report&nbsp;ZEDR17_PRACTICE006<br />
*&---------------------------------------------------------------------*<br />
*&<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
report zedr17_practice006 message-id zmed17. " message ## ## ### ##<br />
<br />
constants: c_flag_quit  type zedt17_102-zqflag value 'X'.  " ## ### (102-zqflag# '##' ###)<br />
constants: c_rank_a     type zedt17_104-zrank  value 'A'.  " ## A ## ##<br />
constants: c_bonus_a    type zedt17_106-zsalary value '500'. " A## ###(= 50,000#, ###=500.00)<br />
constants: c_curr_krw   type c length 3 value 'KRW'.       " ####: ## ##<br />
constants: c_alv_save   type c value 'A'.                  " ALV #### ## ##(A=##### ##)<br />
<br />
tables : zedt17_102, zedt17_103, zedt17_104, zedt17_105, zedt17_106. " ### ##<br />
<br />
   </div>
   <div class="codeComment">
*1.&nbsp;######&nbsp;alv&nbsp;###<br />
*-&nbsp;####(102),&nbsp;####(103),<br />
*-&nbsp;####(102),&nbsp;###(102#####&nbsp;##?),&nbsp;###(102#####&nbsp;##?),&nbsp;###(102),&nbsp;####(102),<br />
*-&nbsp;##(103),&nbsp;##(103),<br />
*-&nbsp;####(106),&nbsp;###(106#####&nbsp;##?),&nbsp;####(106)<br />
   </div>
   <div class="code">
data : begin of gs_result_emp,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpernr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zpernr,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_103-zpname,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdepcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zdepcode,&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdepname(20),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###(102&nbsp;####&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdeprank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zdeprank,&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zrankname(20),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###(102&nbsp;####&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zedate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zedate,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqflag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqflag,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####(##/##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqdate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqdate,&nbsp;&nbsp;&nbsp;"&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqtext(10),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####(##/##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgentext(10),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zgender&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_103-zgender,&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zaddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_103-zaddress,&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zbankcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_106-zbankcode,&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zbankname(20),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###(106&nbsp;####&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zaccount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_106-zaccount,&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;of&nbsp;gs_result_emp.<br />
data : gt_result_emp like table of gs_result_emp.<br />
<br />
   </div>
   <div class="codeComment">
*2.&nbsp;####&nbsp;alv&nbsp;###<br />
*-&nbsp;####(102),&nbsp;####(103),<br />
*-&nbsp;####(102),&nbsp;###(102#####&nbsp;##?),&nbsp;###(102#####&nbsp;##?),&nbsp;###(102),<br />
*-&nbsp;####(106),&nbsp;####(104),&nbsp;xx####(105)<br />
   </div>
   <div class="code">
data : begin of gs_result_eval,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpernr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zpernr,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_103-zpname,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdepcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zdepcode,&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdepname(20),&nbsp;&nbsp;"&nbsp;###(102&nbsp;####&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdeprank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zdeprank,&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zrankname(20),&nbsp;"&nbsp;###(102&nbsp;####&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zedate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zedate,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqflag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqflag,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####(##/##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqtext(10),&nbsp;&nbsp;"&nbsp;####(##/##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqdate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqdate,&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zsalary&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_106-zsalary,&nbsp;&nbsp;&nbsp;"&nbsp;####(##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zevalrank&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_104-zrank,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####(104)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpay_month&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_105-zmon01,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#&nbsp;###(105)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;of&nbsp;gs_result_eval.<br />
data : gt_result_eval like table of gs_result_eval.<br />
<br />
" ## ### ##<br />
data : gv_first_date type sy-datum.<br />
data : gv_last_date type sy-datum.<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;selection&nbsp;screen:&nbsp;##&nbsp;##&nbsp;##&nbsp;**<br />
   </div>
   <div class="code">
selection-screen begin of block b1 with frame.<br />
select-options : s_zpernr for zedt17_102-zpernr. " ####<br />
select-options : s_zedate for zedt17_102-zedate modif id m1. " ###(#### #)<br />
parameters : p_zdep like zedt17_102-zdepcode modif id m1. " ####(##)<br />
parameters : p_year type bkpf-gjahr default sy-datum(4) modif id m2. " yyyy(##/## #)<br />
parameters : p_month type bkpf-monat default sy-datum+4(2) modif id m2. " mm(##/## #)<br />
selection-screen end of block b1.<br />
<br />
selection-screen begin of block b2 with frame.<br />
parameters : pr_emp radiobutton group r1 default 'X' user-command uc1. " #### ### ##<br />
parameters : pr_pay radiobutton group r1. " #### ### ##<br />
parameters : pr_eval radiobutton group r1. " #### ### ##<br />
selection-screen end of block b2.<br />
<br />
selection-screen begin of block b3 with frame.<br />
parameters : p_active as checkbox default 'X' modif id m1. " #### ##<br />
selection-screen end of block b3.<br />
<br />
initialization.<br />
&nbsp;&nbsp;concatenate&nbsp;sy-datum(4)&nbsp;'0101'&nbsp;into&nbsp;gv_first_date.&nbsp;"&nbsp;##&nbsp;(yyyy0101)<br />
&nbsp;&nbsp;concatenate&nbsp;sy-datum(6)&nbsp;'01'&nbsp;into&nbsp;gv_last_date.&nbsp;"&nbsp;##&nbsp;1#&nbsp;(yyyymm01)<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;###&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;'RP_LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;day_in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gv_last_date<br />
&nbsp;&nbsp;&nbsp;&nbsp;importing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_day_of_month&nbsp;=&nbsp;gv_last_date.<br />
<br />
&nbsp;&nbsp;clear&nbsp;s_zedate.<br />
&nbsp;&nbsp;s_zedate-sign&nbsp;=&nbsp;'I'.&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;s_zedate-option&nbsp;=&nbsp;'BT'.&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;s_zedate-low&nbsp;=&nbsp;gv_first_date.&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;s_zedate-high&nbsp;=&nbsp;gv_last_date.&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;append&nbsp;s_zedate.<br />
<br />
&nbsp;&nbsp;p_active&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;#####&nbsp;####&nbsp;##&nbsp;#.<br />
&nbsp;&nbsp;pr_emp&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;#####&nbsp;##&nbsp;#.<br />
<br />
at selection-screen output.<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;lv_d_active(1).&nbsp;"&nbsp;####&nbsp;##&nbsp;##(####)<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;lv_ym_eval_active(1).&nbsp;"&nbsp;#/#&nbsp;##&nbsp;##(##/##)<br />
<br />
&nbsp;&nbsp;if&nbsp;pr_emp&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;######&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_d_active&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;on<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_ym_eval_active&nbsp;=&nbsp;'0'.&nbsp;"&nbsp;#/#&nbsp;off<br />
&nbsp;&nbsp;else.&nbsp;"&nbsp;####&nbsp;or&nbsp;####&nbsp;######&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_d_active&nbsp;=&nbsp;'0'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;off<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_ym_eval_active&nbsp;=&nbsp;'1'.&nbsp;"&nbsp;#/#&nbsp;on<br />
&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;loop&nbsp;at&nbsp;screen.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;screen-group1&nbsp;=&nbsp;'M1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-active&nbsp;=&nbsp;lv_d_active.&nbsp;"&nbsp;####&nbsp;##&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;screen-group1&nbsp;=&nbsp;'M2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen-active&nbsp;=&nbsp;lv_ym_eval_active.&nbsp;"&nbsp;&nbsp;####&nbsp;or&nbsp;####&nbsp;##&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;screen.<br />
&nbsp;&nbsp;endloop.<br />
<br />
at selection-screen.<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;lv_all_empty(1)&nbsp;value&nbsp;'X'.&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;range#&nbsp;##&nbsp;#&nbsp;##&nbsp;flag<br />
&nbsp;&nbsp;if&nbsp;pr_emp&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;######&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"s_zedate##&nbsp;#&nbsp;####&nbsp;low/high#&nbsp;###&nbsp;##&nbsp;ok<br />
&nbsp;&nbsp;&nbsp;&nbsp;loop&nbsp;at&nbsp;s_zedate.&nbsp;"&nbsp;range###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s_zedate-low&nbsp;is&nbsp;not&nbsp;initial&nbsp;or&nbsp;s_zedate-high&nbsp;is&nbsp;not&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_all_empty&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endloop.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#&nbsp;##&nbsp;#&nbsp;####&nbsp;###&nbsp;##&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_all_empty&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;e000.&nbsp;"&nbsp;"#####&nbsp;######"&nbsp;#####&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop.&nbsp;"&nbsp;##&nbsp;###&nbsp;stop<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;else.&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;or&nbsp;####&nbsp;######&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p_year&nbsp;is&nbsp;initial&nbsp;or&nbsp;p_month&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;e000.&nbsp;"&nbsp;'#####&nbsp;######;&nbsp;#####&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stop.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;endif.<br />
<br />
start-of-selection.<br />
&nbsp;&nbsp;if&nbsp;pr_emp&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;get_emp_data.&nbsp;"&nbsp;####&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;alv_emp_display.&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;elseif&nbsp;pr_pay&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;pay_update.&nbsp;"&nbsp;##&nbsp;##&nbsp;###&nbsp;update<br />
&nbsp;&nbsp;else.&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;get_eval_data.&nbsp;"####&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;alv_eval_display.&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;endif.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_EMP_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;####(M1)&nbsp;##<br />
*&nbsp;-&nbsp;102(####)&nbsp;+&nbsp;103(##)&nbsp;+&nbsp;106(##/##)&nbsp;##&nbsp;##<br />
*&nbsp;-&nbsp;##(s_zpernr),&nbsp;###(s_zedate),&nbsp;(##)####(p_zdep),&nbsp;(##)####(p_active='X')<br />
*&nbsp;-&nbsp;gt_result_emp&nbsp;#&nbsp;##&nbsp;#&nbsp;####&nbsp;##(CASE)<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form get_emp_data .<br />
&nbsp;&nbsp;clear&nbsp;gt_result_emp.<br />
<br />
&nbsp;&nbsp;if&nbsp;p_zdep&nbsp;is&nbsp;initial&nbsp;and&nbsp;p_active&nbsp;&lt;&gt;&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;###&nbsp;+&nbsp;####&nbsp;checkbox&nbsp;##&nbsp;##&nbsp;##(##/##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;####&nbsp;##&nbsp;##(##/###)#&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##+##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;select<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~zpernr&nbsp;&nbsp;a~zdepcode&nbsp;&nbsp;a~zdeprank&nbsp;&nbsp;a~zedate&nbsp;&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname&nbsp;&nbsp;b~zgender&nbsp;&nbsp;&nbsp;b~zaddress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zbankcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zaccount<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_emp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;in&nbsp;s_zpernr&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;in&nbsp;s_zedate.&nbsp;"&nbsp;###&nbsp;##<br />
<br />
&nbsp;&nbsp;elseif&nbsp;p_zdep&nbsp;is&nbsp;initial&nbsp;and&nbsp;p_active&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;###&nbsp;+&nbsp;'####'&nbsp;checkbox&nbsp;##(####)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;##&nbsp;##&nbsp;##&nbsp;####,&nbsp;####&nbsp;####&nbsp;'###'#<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;a~zqflag&nbsp;&lt;&gt;&nbsp;c_flag_quit&nbsp;(X=##,&nbsp;##=##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;select<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~zpernr&nbsp;&nbsp;a~zdepcode&nbsp;&nbsp;a~zdeprank&nbsp;&nbsp;a~zedate&nbsp;&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname&nbsp;&nbsp;b~zgender&nbsp;&nbsp;&nbsp;b~zaddress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zbankcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zaccount<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_emp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;in&nbsp;s_zedate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zqflag&nbsp;&lt;&gt;&nbsp;c_flag_quit.&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;elseif&nbsp;p_zdep&nbsp;is&nbsp;not&nbsp;initial&nbsp;and&nbsp;p_active&nbsp;&lt;&gt;&nbsp;'X'.&nbsp;"&nbsp;##&nbsp;##&nbsp;##&nbsp;+&nbsp;'####'&nbsp;##&nbsp;#&nbsp;#(##/##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###&nbsp;##&nbsp;###&nbsp;##,&nbsp;##/##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;+&nbsp;##&nbsp;##&nbsp;(zqflag&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;'#####&nbsp;##&nbsp;#&nbsp;##&nbsp;##(###&nbsp;##)&nbsp;##&nbsp;##'<br />
&nbsp;&nbsp;&nbsp;&nbsp;select<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~zpernr&nbsp;&nbsp;a~zdepcode&nbsp;&nbsp;a~zdeprank&nbsp;&nbsp;a~zedate&nbsp;&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname&nbsp;&nbsp;b~zgender&nbsp;&nbsp;&nbsp;b~zaddress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zbankcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zaccount<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_emp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;&nbsp;in&nbsp;s_zedate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;&nbsp;p_zdep.&nbsp;"&nbsp;##&nbsp;###<br />
<br />
&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;##&nbsp;+&nbsp;'####'&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;+&nbsp;##&nbsp;##&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;a~zqflag&nbsp;&lt;&gt;&nbsp;c_flag_quit&nbsp;(##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;select<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a~zpernr&nbsp;&nbsp;a~zdepcode&nbsp;&nbsp;a~zdeprank&nbsp;&nbsp;a~zedate&nbsp;&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname&nbsp;&nbsp;b~zgender&nbsp;&nbsp;&nbsp;b~zaddress<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zbankcode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zaccount<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_emp<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;&nbsp;in&nbsp;s_zedate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;&nbsp;p_zdep<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zqflag&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;c_flag_quit.&nbsp;"&nbsp;####+####<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;p_active&nbsp;####&nbsp;#:&nbsp;####&nbsp;##&nbsp;##&nbsp;##&nbsp;##(=&nbsp;###&nbsp;#&nbsp;##)#&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;if&nbsp;p_active&nbsp;&lt;&gt;&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;gt_result_emp&nbsp;where&nbsp;zqflag&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zqdate&nbsp;is&nbsp;not&nbsp;initial<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zqdate&nbsp;&lt;=&nbsp;s_zedate-high.&nbsp;"&nbsp;####&nbsp;##&nbsp;##&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;-&gt;&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;loop&nbsp;at&nbsp;gt_result_emp&nbsp;into&nbsp;gs_result_emp.<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;map_emp_texts&nbsp;using<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zdepcode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zdeprank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zbankcode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zqflag<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zgender<br />
&nbsp;&nbsp;&nbsp;&nbsp;changing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zdepname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zrankname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zbankname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zqtext&nbsp;&nbsp;&nbsp;"&nbsp;##/##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_emp-zgentext.&nbsp;"&nbsp;##/##&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_result_emp&nbsp;from&nbsp;gs_result_emp.<br />
&nbsp;&nbsp;endloop.<br />
<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;alv_emp_display<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_emp_display .<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;###&nbsp;###&nbsp;##&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;if&nbsp;gt_result_emp&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'###&nbsp;####&nbsp;####.'&nbsp;type&nbsp;'E'.&nbsp;"&nbsp;#&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;exit.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;gs_fieldcat&nbsp;type&nbsp;slis_fieldcat_alv.<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;gt_fieldcat&nbsp;type&nbsp;slis_t_fieldcat_alv.<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;gs_layout&nbsp;&nbsp;&nbsp;type&nbsp;slis_layout_alv.&nbsp;&nbsp;"&nbsp;layout<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;gs_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;slis_sortinfo_alv.&nbsp;&nbsp;"&nbsp;sort<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;gt_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;slis_t_sortinfo_alv.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat,&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;####&nbsp;##(##&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZPERNR'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZPNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZDEPCODE'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZDEPNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZRANKNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZEDATE'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;gs_fieldcat-outputlen&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZQTEXT'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZGENTEXT'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZADDRESS'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZBANKNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZACCOUNT'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;####&nbsp;####(s_zedate-high)##&nbsp;#&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;delete&nbsp;gt_result_emp&nbsp;where&nbsp;zedate&nbsp;&gt;&nbsp;s_zedate-high.<br />
<br />
&nbsp;&nbsp;"&nbsp;####:&nbsp;###(zebra),&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;clear&nbsp;gs_layout.<br />
&nbsp;&nbsp;gs_layout-colwidth_optimize&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_layout-zebra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;"&nbsp;##:&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;clear&nbsp;gt_sort.<br />
&nbsp;&nbsp;gs_sort-spos&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'ZPERNR'.<br />
&nbsp;&nbsp;gs_sort-up&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;append&nbsp;gs_sort&nbsp;to&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV&nbsp;##<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_callback_program&nbsp;=&nbsp;sy-repid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_fieldcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;c_alv_save&nbsp;"&nbsp;###&nbsp;####&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_result_emp<br />
&nbsp;&nbsp;&nbsp;&nbsp;exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'ALV&nbsp;##&nbsp;#&nbsp;###&nbsp;######.'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;endif.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MAP_EMP_TEXTS<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
" ####, ####, ####, ####, ## ## -&gt; ### ##<br />
form map_emp_texts using    p_zdepcode  type zedt17_102-zdepcode   " ####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zdeprank&nbsp;&nbsp;type&nbsp;zedt17_102-zdeprank&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zbankcode&nbsp;type&nbsp;zedt17_106-zbankcode&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zqflag&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqflag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zgender&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_103-zgender&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;changing&nbsp;&nbsp;p_zdepname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zrankname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zbankname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zqtext<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_zgentext.<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;case&nbsp;p_zdepcode.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'SS0001'.&nbsp;p_zdepname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'SS0002'.&nbsp;p_zdepname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'SS0003'.&nbsp;p_zdepname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'SS0004'.&nbsp;p_zdepname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'SS0005'.&nbsp;p_zdepname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'SS0006'.&nbsp;p_zdepname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;endcase.<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;case&nbsp;p_zdeprank.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'A'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'B'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'C'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'D'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'E'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'F'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'G'.&nbsp;p_zrankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;endcase.<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;case&nbsp;p_zbankcode.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'001'.&nbsp;p_zbankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'002'.&nbsp;p_zbankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'003'.&nbsp;p_zbankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'004'.&nbsp;p_zbankname&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'005'.&nbsp;p_zbankname&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;endcase.<br />
<br />
&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;if&nbsp;p_zqflag&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_zqtext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_zqtext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;if&nbsp;p_zgender&nbsp;=&nbsp;'M'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_zgentext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;elseif&nbsp;p_zgender&nbsp;=&nbsp;'F'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;p_zgentext&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;endif.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_EVAL_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;####(M2)&nbsp;##<br />
*&nbsp;-&nbsp;102(##)&nbsp;+&nbsp;103(##)&nbsp;+&nbsp;104(##)&nbsp;+&nbsp;106(##)<br />
*&nbsp;-&nbsp;105(##)#&nbsp;##&nbsp;####&nbsp;##&nbsp;###&nbsp;##<br />
*&nbsp;-&nbsp;###&nbsp;0##&nbsp;##&nbsp;##<br />
*&nbsp;-&nbsp;###,&nbsp;###&nbsp;####&nbsp;(PERFORM&nbsp;map_emp_texts)<br />
*&nbsp;-&nbsp;##&nbsp;###&nbsp;##(#)#&nbsp;##<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form get_eval_data .<br />
&nbsp;&nbsp;clear&nbsp;gt_result_eval.<br />
&nbsp;&nbsp;p_active&nbsp;=&nbsp;space.&nbsp;"&nbsp;#####&nbsp;###&nbsp;###(####&nbsp;##&nbsp;#&nbsp;###&nbsp;####&nbsp;##)<br />
<br />
&nbsp;&nbsp;"&nbsp;####/##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;data:&nbsp;lv_mon_first&nbsp;type&nbsp;sy-datum.<br />
&nbsp;&nbsp;data:&nbsp;lv_mon_last&nbsp;&nbsp;type&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;concatenate&nbsp;p_year&nbsp;p_month&nbsp;'01'&nbsp;into&nbsp;lv_mon_first.<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;'RP_LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;day_in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_mon_first<br />
&nbsp;&nbsp;&nbsp;&nbsp;importing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_day_of_month&nbsp;=&nbsp;lv_mon_last.<br />
<br />
&nbsp;&nbsp;"&nbsp;##/##&nbsp;##&nbsp;+&nbsp;##&nbsp;##&nbsp;###&nbsp;##&nbsp;##&nbsp;(###&nbsp;#&nbsp;4#)<br />
&nbsp;&nbsp;if&nbsp;p_zdep&nbsp;is&nbsp;initial&nbsp;and&nbsp;p_active&nbsp;&lt;&gt;&nbsp;'X'.&nbsp;&nbsp;"&nbsp;case&nbsp;1&nbsp;:&nbsp;##&nbsp;X,&nbsp;####&nbsp;X<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s_zpernr&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zedate&nbsp;&lt;=&nbsp;lv_mon_last.<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;&lt;=&nbsp;lv_mon_last.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;elseif&nbsp;p_zdep&nbsp;is&nbsp;initial&nbsp;and&nbsp;p_active&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;case&nbsp;2&nbsp;:&nbsp;##&nbsp;X,&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s_zpernr&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zedate&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zqflag&nbsp;&lt;&gt;&nbsp;c_flag_quit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zqflag&nbsp;&lt;&gt;&nbsp;c_flag_quit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;elseif&nbsp;p_zdep&nbsp;is&nbsp;not&nbsp;initial&nbsp;and&nbsp;p_active&nbsp;&lt;&gt;&nbsp;'X'.&nbsp;&nbsp;"&nbsp;case&nbsp;3&nbsp;:&nbsp;##&nbsp;O,&nbsp;####&nbsp;X<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s_zpernr&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zedate&nbsp;&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;p_zdep.<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;p_zdep.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;else.&nbsp;&nbsp;"&nbsp;case&nbsp;4&nbsp;:&nbsp;##&nbsp;O,&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;s_zpernr&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zedate&nbsp;&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;p_zdep<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zqflag&nbsp;&lt;&gt;&nbsp;c_flag_quit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b~zpname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zrank&nbsp;&nbsp;as&nbsp;zevalrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_103&nbsp;as&nbsp;b&nbsp;on&nbsp;b~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;left&nbsp;&nbsp;outer&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zpernr&nbsp;&nbsp;in&nbsp;s_zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zedate&nbsp;&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;p_zdep<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zqflag&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;endif.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"&nbsp;##&nbsp;###:&nbsp;##&nbsp;#&nbsp;###&nbsp;####&nbsp;ZMON01~12&nbsp;##<br />
*&nbsp;&nbsp;data:&nbsp;lv_mon2(2).<br />
*&nbsp;&nbsp;data:&nbsp;lv_fieldname&nbsp;type&nbsp;fieldname.<br />
*&nbsp;&nbsp;lv_mon2&nbsp;=&nbsp;p_month.<br />
*&nbsp;&nbsp;condense&nbsp;lv_mon2&nbsp;no-gaps.<br />
*&nbsp;&nbsp;if&nbsp;strlen(&nbsp;lv_mon2&nbsp;)&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;concatenate&nbsp;'0'&nbsp;lv_mon2&nbsp;into&nbsp;lv_mon2.<br />
*&nbsp;&nbsp;endif.<br />
*&nbsp;&nbsp;concatenate&nbsp;'ZMON'&nbsp;lv_mon2&nbsp;into&nbsp;lv_fieldname.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;####(#&nbsp;changing&nbsp;####&nbsp;####,&nbsp;##&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;data:&nbsp;lv_bankname(20).<br />
&nbsp;&nbsp;data:&nbsp;lv_gtext(10).<br />
&nbsp;&nbsp;data:&nbsp;lv_qtext(10).<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;+&nbsp;0#&nbsp;##&nbsp;+&nbsp;##/##&nbsp;##<br />
&nbsp;&nbsp;data&nbsp;lv_pay&nbsp;type&nbsp;zedt17_105-zmon01.<br />
&nbsp;&nbsp;"&nbsp;#&nbsp;###(#&nbsp;##)&nbsp;##:&nbsp;'01'&nbsp;~&nbsp;'12'<br />
&nbsp;&nbsp;data&nbsp;lv_mon2(2).<br />
&nbsp;&nbsp;lv_mon2&nbsp;=&nbsp;p_month.<br />
&nbsp;&nbsp;condense&nbsp;lv_mon2&nbsp;no-gaps.<br />
&nbsp;&nbsp;if&nbsp;strlen(&nbsp;lv_mon2&nbsp;)&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;concatenate&nbsp;'0'&nbsp;lv_mon2&nbsp;into&nbsp;lv_mon2.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;loop&nbsp;at&nbsp;gt_result_eval&nbsp;into&nbsp;gs_result_eval.<br />
&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;lv_pay.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;lv_mon2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'01'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon01&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'02'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon02&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'03'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon03&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'04'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon04&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'05'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon05&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'06'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon06&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'07'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon07&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'08'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon08&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'09'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon09&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'10'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon10&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'11'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon11&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'12'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;zmon12&nbsp;into&nbsp;lv_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_result_eval-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endcase.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##(lv_mon_last)&nbsp;####&nbsp;##&nbsp;#####&nbsp;0#&nbsp;##(##&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs_result_eval-zqflag&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;gs_result_eval-zqdate&nbsp;is&nbsp;not&nbsp;initial<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;gs_result_eval-zqdate&nbsp;&lt;=&nbsp;lv_mon_last.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_pay&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;0##&nbsp;#####&nbsp;##&nbsp;(##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_pay&nbsp;is&nbsp;initial&nbsp;or&nbsp;lv_pay&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;gt_result_eval&nbsp;index&nbsp;sy-tabix.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zpay_month&nbsp;=&nbsp;lv_pay.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;(##/##/######&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;perform&nbsp;map_emp_texts&nbsp;using<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zdepcode<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zdeprank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zqflag<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space<br />
&nbsp;&nbsp;&nbsp;&nbsp;changing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zdepname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zrankname<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_bankname&nbsp;"&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_qtext&nbsp;&nbsp;"&nbsp;##/##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_gtext.&nbsp;&nbsp;"&nbsp;##&nbsp;###&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;gs_result_eval-zqtext&nbsp;=&nbsp;lv_qtext.<br />
&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_result_eval&nbsp;from&nbsp;gs_result_eval.<br />
&nbsp;&nbsp;endloop.<br />
<br />
endform.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_EVAL_DISPLAY<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_eval_display .<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;###&nbsp;##&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;if&nbsp;gt_result_eval&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'###&nbsp;##&nbsp;####&nbsp;####.'&nbsp;type&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;exit.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;data:&nbsp;gs_fieldcat&nbsp;type&nbsp;slis_fieldcat_alv.<br />
&nbsp;&nbsp;data:&nbsp;gt_fieldcat&nbsp;type&nbsp;slis_t_fieldcat_alv.<br />
&nbsp;&nbsp;data:&nbsp;gs_layout&nbsp;type&nbsp;slis_layout_alv.<br />
&nbsp;&nbsp;data:&nbsp;gs_sort&nbsp;type&nbsp;slis_sortinfo_alv.<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;gt_sort&nbsp;type&nbsp;slis_t_sortinfo_alv.<br />
<br />
&nbsp;&nbsp;clear:&nbsp;gs_fieldcat,&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;1)&nbsp;####<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZPERNR'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;2)&nbsp;####<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZPNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-key&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;3)&nbsp;####<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZDEPCODE'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;4)&nbsp;###<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZDEPNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;5)&nbsp;###<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZRANKNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;6)&nbsp;###<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZEDATE'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;gs_fieldcat-outputlen&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;7)&nbsp;####(##)&nbsp;##/##<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZSALARY'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-do_sum&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-currency&nbsp;=&nbsp;c_curr_krw.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;8)&nbsp;####<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZEVALRANK'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;9)&nbsp;###&nbsp;###&nbsp;##/##&nbsp;(###&nbsp;###&nbsp;##)<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZPAY_MONTH'.<br />
&nbsp;&nbsp;gs_fieldcat-seltext_m&nbsp;=&nbsp;|{&nbsp;p_month&nbsp;}####|.<br />
&nbsp;&nbsp;gs_fieldcat-do_sum&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_fieldcat-currency&nbsp;&nbsp;=&nbsp;c_curr_krw.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
&nbsp;&nbsp;clear&nbsp;gs_fieldcat.<br />
<br />
&nbsp;&nbsp;"&nbsp;####(zebre/####)<br />
&nbsp;&nbsp;clear&nbsp;gs_layout.<br />
&nbsp;&nbsp;gs_layout-colwidth_optimize&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;gs_layout-zebra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;"&nbsp;##:&nbsp;##<br />
&nbsp;&nbsp;clear:&nbsp;gt_sort.<br />
&nbsp;&nbsp;gs_sort-spos&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'ZPERNR'.<br />
&nbsp;&nbsp;gs_sort-up&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;append&nbsp;gs_sort&nbsp;to&nbsp;gt_sort.<br />
<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;'REUSE_ALV_GRID_DISPLAY'<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_callback_program&nbsp;=&nbsp;sy-repid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_fieldcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_sort<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;c_alv_save<br />
&nbsp;&nbsp;&nbsp;&nbsp;tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_result_eval<br />
&nbsp;&nbsp;&nbsp;&nbsp;exceptions<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;program_error&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;PAY_UPDATE<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;13-2.&nbsp;####<br />
*&nbsp;1)&nbsp;ALV&nbsp;##&nbsp;##.&nbsp;##/##&nbsp;###<br />
*&nbsp;2)&nbsp;##&nbsp;#&nbsp;ZMONXX#&nbsp;UPDATE&nbsp;(CASE&nbsp;##)<br />
*&nbsp;3)&nbsp;####&nbsp;##&nbsp;(#:&nbsp;3#&nbsp;##&nbsp;#&nbsp;3#&nbsp;##&nbsp;##)<br />
*&nbsp;4)&nbsp;##&nbsp;##&nbsp;#####&nbsp;####&nbsp;##<br />
*&nbsp;5)&nbsp;##&nbsp;=&nbsp;##/12,&nbsp;##&nbsp;A#&nbsp;+50,000<br />
*&nbsp;6)&nbsp;ZEDT17_105&nbsp;CURR&nbsp;####&nbsp;##&nbsp;##(#:&nbsp;1000#&nbsp;#&nbsp;10.00##&nbsp;/100&nbsp;##)<br />
*&nbsp;7)&nbsp;##&nbsp;#&nbsp;#&nbsp;1####&nbsp;##&nbsp;#&nbsp;##&nbsp;###&nbsp;##<br />
*&nbsp;8)&nbsp;0##&nbsp;######&nbsp;##<br />
*---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form pay_update .<br />
<br />
&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;if&nbsp;p_year&nbsp;is&nbsp;initial&nbsp;or&nbsp;p_month&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;e000.&nbsp;&nbsp;&nbsp;"&nbsp;#####&nbsp;######<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;data:&nbsp;lv_mon_first&nbsp;type&nbsp;sy-datum.<br />
&nbsp;&nbsp;data:&nbsp;lv_mon_last&nbsp;&nbsp;type&nbsp;sy-datum.<br />
<br />
&nbsp;&nbsp;concatenate&nbsp;p_year&nbsp;p_month&nbsp;'01'&nbsp;into&nbsp;lv_mon_first.<br />
&nbsp;&nbsp;call&nbsp;function&nbsp;'RP_LAST_DAY_OF_MONTHS'<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;day_in&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;lv_mon_first<br />
&nbsp;&nbsp;&nbsp;&nbsp;importing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_day_of_month&nbsp;=&nbsp;lv_mon_last.<br />
<br />
&nbsp;&nbsp;"&nbsp;#(#&nbsp;##)&nbsp;###:&nbsp;'01'&nbsp;~&nbsp;'12'<br />
&nbsp;&nbsp;data&nbsp;lv_mon2(2).<br />
&nbsp;&nbsp;lv_mon2&nbsp;=&nbsp;p_month.<br />
&nbsp;&nbsp;condense&nbsp;lv_mon2&nbsp;no-gaps.<br />
&nbsp;&nbsp;if&nbsp;strlen(&nbsp;lv_mon2&nbsp;)&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;concatenate&nbsp;'0'&nbsp;lv_mon2&nbsp;into&nbsp;lv_mon2.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;####&nbsp;##&nbsp;##&nbsp;(##&nbsp;##&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;data:&nbsp;begin&nbsp;of&nbsp;gs_cand,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zpernr&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zpernr,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdepcode&nbsp;type&nbsp;zedt17_102-zdepcode,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zdeprank&nbsp;type&nbsp;zedt17_102-zdeprank,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zedate&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zedate,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqflag&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqflag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zqdate&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_102-zqdate,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zyear&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_104-zyear,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zrank&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_104-zrank,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zsalary&nbsp;&nbsp;type&nbsp;zedt17_106-zsalary,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end&nbsp;of&nbsp;gs_cand.<br />
&nbsp;&nbsp;data:&nbsp;gt_cand&nbsp;like&nbsp;table&nbsp;of&nbsp;gs_cand.<br />
<br />
&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;###&nbsp;&lt;=&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;####&nbsp;###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;##(104)&nbsp;##&nbsp;=&nbsp;p_year,&nbsp;##(106)&nbsp;##&nbsp;=&nbsp;p_year<br />
&nbsp;&nbsp;clear&nbsp;gt_cand.<br />
<br />
&nbsp;&nbsp;if&nbsp;p_zdep&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zyear&nbsp;&nbsp;c~zrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_cand<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zedate&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;c~zyear&nbsp;&nbsp;=&nbsp;&nbsp;p_year<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;d~zyear&nbsp;&nbsp;=&nbsp;&nbsp;p_year.<br />
&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;a~zpernr&nbsp;a~zdepcode&nbsp;a~zdeprank&nbsp;a~zedate&nbsp;a~zqflag&nbsp;a~zqdate<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c~zyear&nbsp;&nbsp;c~zrank<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d~zsalary<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_cand<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_102&nbsp;as&nbsp;a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_104&nbsp;as&nbsp;c&nbsp;on&nbsp;c~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;inner&nbsp;join&nbsp;zedt17_106&nbsp;as&nbsp;d&nbsp;on&nbsp;d~zpernr&nbsp;=&nbsp;a~zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;a~zedate&nbsp;&nbsp;&lt;=&nbsp;lv_mon_last<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a~zdepcode&nbsp;=&nbsp;&nbsp;p_zdep<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;c~zyear&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;p_year<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;d~zyear&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;p_year.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;if&nbsp;gt_cand&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;i002.&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;###&nbsp;####.<br />
&nbsp;&nbsp;&nbsp;&nbsp;exit.<br />
&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;105&nbsp;#&nbsp;#&nbsp;##&nbsp;+&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;data:&nbsp;ls_pay&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_105.<br />
&nbsp;&nbsp;data:&nbsp;lv_amount&nbsp;type&nbsp;zedt17_105-zmon01.&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;(CURR)<br />
&nbsp;&nbsp;data:&nbsp;lv_raw&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;zedt17_106-zsalary.&nbsp;&nbsp;"&nbsp;##(CURR)<br />
<br />
&nbsp;&nbsp;data&nbsp;lv_failed&nbsp;type&nbsp;c&nbsp;value&nbsp;space.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;loop&nbsp;at&nbsp;gt_cand&nbsp;into&nbsp;gs_cand.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##:&nbsp;###&nbsp;##&nbsp;####&nbsp;####&nbsp;###&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;check&nbsp;not&nbsp;(&nbsp;gs_cand-zqflag&nbsp;=&nbsp;c_flag_quit<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;gs_cand-zqdate&nbsp;is&nbsp;not&nbsp;initial<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;gs_cand-zqdate&nbsp;&lt;=&nbsp;lv_mon_last&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;=&nbsp;##/12<br />
&nbsp;&nbsp;&nbsp;&nbsp;clear:&nbsp;lv_raw,&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##/12<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_raw&nbsp;=&nbsp;gs_cand-zsalary&nbsp;/&nbsp;12.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;A##&nbsp;###:&nbsp;50,000#&nbsp;=&nbsp;500.00(CURR&nbsp;###)<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs_cand-zrank&nbsp;=&nbsp;c_rank_a.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_raw&nbsp;=&nbsp;lv_raw&nbsp;+&nbsp;c_bonus_a.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;0###&nbsp;##(####&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_raw&nbsp;&lt;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lv_amount&nbsp;=&nbsp;lv_raw.&nbsp;"&nbsp;###&nbsp;#####&nbsp;###&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####&nbsp;####&nbsp;###&nbsp;##/####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;ls_pay.<br />
&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;single&nbsp;*&nbsp;into&nbsp;ls_pay<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;zedt17_105<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;zpernr&nbsp;=&nbsp;gs_cand-zpernr<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;lv_exist&nbsp;type&nbsp;c&nbsp;value&nbsp;space.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_exist&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;ls_pay.&nbsp;"&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_pay-zpernr&nbsp;=&nbsp;gs_cand-zpernr.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ls_pay-zyear&nbsp;&nbsp;=&nbsp;p_year.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;CASE#&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;lv_mon2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'01'.&nbsp;ls_pay-zmon01&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'02'.&nbsp;ls_pay-zmon02&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'03'.&nbsp;ls_pay-zmon03&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'04'.&nbsp;ls_pay-zmon04&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'05'.&nbsp;ls_pay-zmon05&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'06'.&nbsp;ls_pay-zmon06&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'07'.&nbsp;ls_pay-zmon07&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'08'.&nbsp;ls_pay-zmon08&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'09'.&nbsp;ls_pay-zmon09&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'10'.&nbsp;ls_pay-zmon10&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'11'.&nbsp;ls_pay-zmon11&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'12'.&nbsp;ls_pay-zmon12&nbsp;=&nbsp;lv_amount.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endcase.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##:&nbsp;###&nbsp;MODIFY,&nbsp;###&nbsp;INSERT<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_exist&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;zedt17_105&nbsp;from&nbsp;ls_pay.<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;insert&nbsp;zedt17_105&nbsp;from&nbsp;ls_pay.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;#&nbsp;##&nbsp;##&nbsp;-&gt;&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_failed&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
<br />
&nbsp;&nbsp;endloop.<br />
<br />
&nbsp;&nbsp;"&nbsp;&nbsp;####&nbsp;###.&nbsp;##/##&nbsp;#&nbsp;###<br />
&nbsp;&nbsp;if&nbsp;lv_failed&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;rollback&nbsp;work.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;e003.&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;commit&nbsp;work.<br />
&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;s004.&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;#######.<br />
&nbsp;&nbsp;endif.<br />
<br />
endform.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*Messages<br />
*----------------------------------------------------------<br />
*<br />
*&nbsp;Message&nbsp;class:&nbsp;Hard&nbsp;coded<br />
*&nbsp;&nbsp;&nbsp;###&nbsp;####&nbsp;####.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750</td>
   </tr>
</table>
</body>
</html>
