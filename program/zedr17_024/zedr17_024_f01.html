<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZEDR17_024_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEDR17_024_F01</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEDR17_024_F01<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form set_init .<br />
&nbsp;&nbsp;s_zcode-low&nbsp;=&nbsp;'SSU-01'.<br />
&nbsp;&nbsp;s_zcode-high&nbsp;=&nbsp;'SSU-99'.<br />
&nbsp;&nbsp;append&nbsp;s_zcode.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form get_data .<br />
&nbsp;&nbsp;select&nbsp;*&nbsp;from&nbsp;zedt17_001<br />
&nbsp;&nbsp;into&nbsp;corresponding&nbsp;fields&nbsp;of&nbsp;table&nbsp;gt_student<br />
&nbsp;&nbsp;where&nbsp;zcode&nbsp;in&nbsp;s_zcode.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CREATE_OBJECT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form create_object .<br />
&nbsp;&nbsp;create&nbsp;object&nbsp;gc_docking<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repid&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-repid&nbsp;"&nbsp;docking&nbsp;container&nbsp;####&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynnr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;sy-dynnr&nbsp;"&nbsp;dockiing&nbsp;container&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extension&nbsp;=&nbsp;2000.&nbsp;"&nbsp;&nbsp;####&nbsp;###&nbsp;##&nbsp;##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;if&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;create&nbsp;object&nbsp;gc_grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_parent&nbsp;=&nbsp;gc_docking.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;FIELD_CATALOG<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form field_catalog .<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;1.&nbsp;"&nbsp;coll_pos#&nbsp;###&nbsp;output&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZCOLOR'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'L'.&nbsp;"&nbsp;##&nbsp;##&nbsp;(L#,&nbsp;R#,&nbsp;C##)<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;2.&nbsp;"&nbsp;coll_pos#&nbsp;###&nbsp;output&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZCODE'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'L'.&nbsp;"&nbsp;##&nbsp;##&nbsp;(L#,&nbsp;R#,&nbsp;C##)<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZPERNR'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-just&nbsp;=&nbsp;'C'.&nbsp;"&nbsp;##&nbsp;##&nbsp;(L#,&nbsp;R#,&nbsp;C##)<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZKNAME'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZENAME'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZGENDER'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;gs_fieldcat.<br />
&nbsp;&nbsp;gs_fieldcat-col_pos&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;gs_fieldcat-fieldname&nbsp;=&nbsp;'ZTEL'.<br />
&nbsp;&nbsp;gs_fieldcat-scrtext_m&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;gs_fieldcat-edit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;##&nbsp;####&nbsp;##&nbsp;##&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;gs_fieldcat-outputlen&nbsp;=&nbsp;16.&nbsp;"&nbsp;##&nbsp;###&nbsp;##&nbsp;##/##&nbsp;##&nbsp;#&nbsp;##<br />
<br />
<br />
&nbsp;&nbsp;append&nbsp;gs_fieldcat&nbsp;to&nbsp;gt_fieldcat.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_LAYOUT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_layout .<br />
&nbsp;&nbsp;clear&nbsp;gs_layout.<br />
&nbsp;&nbsp;gs_layout-zebra&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;##&nbsp;###&nbsp;##&nbsp;###&nbsp;-&gt;&nbsp;###&nbsp;##&nbsp;##.&nbsp;#&nbsp;#&nbsp;####&nbsp;##&nbsp;#&nbsp;#<br />
<br />
&nbsp;&nbsp;"&nbsp;variant#&nbsp;####&nbsp;##&nbsp;####&nbsp;##&nbsp;####&nbsp;#####&nbsp;####&nbsp;###&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;(##&nbsp;##&nbsp;##,&nbsp;###,&nbsp;##&nbsp;#)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;gs_layout-edit&nbsp;&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;clear&nbsp;gs_variant.<br />
&nbsp;&nbsp;gs_variant-report&nbsp;=&nbsp;sy-repid.<br />
&nbsp;&nbsp;gs_variant-username&nbsp;=&nbsp;sy-uname.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_SORT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_sort .<br />
&nbsp;&nbsp;gs_sort-spos&nbsp;=&nbsp;1.&nbsp;"&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;gs_sort-fieldname&nbsp;=&nbsp;'ZCODE'.&nbsp;"&nbsp;###&nbsp;###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;gs_sort-up&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;####&nbsp;##<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;gs_sort-down&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####&nbsp;####&nbsp;##<br />
   </div>
   <div class="code">
&nbsp;&nbsp;gs_sort-subtot&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;append&nbsp;gs_sort&nbsp;to&nbsp;gt_sort.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_DISPLAY<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_display .<br />
&nbsp;&nbsp;call&nbsp;method&nbsp;gc_grid-&gt;set_table_for_first_display<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_variant&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_variant<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_save&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'&nbsp;"&nbsp;alv#####&nbsp;####&nbsp;#####&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_layout&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gs_layout&nbsp;"-&gt;&nbsp;#&nbsp;not&nbsp;valid&nbsp;##??<br />
&nbsp;&nbsp;&nbsp;&nbsp;changing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_outtab&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_student<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcatalog&nbsp;=&nbsp;gt_fieldcat<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;gt_sort.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;REFRESH<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form refresh .<br />
&nbsp;&nbsp;"&nbsp;lvc_s_stbl&nbsp;###&nbsp;se24&nbsp;-&gt;&nbsp;cl_gui_alv_grid##&nbsp;REFRESH_TABLE_DISPLAY&nbsp;#####&nbsp;signature#&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;ls_stable&nbsp;type&nbsp;lvc_s_stbl.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV&nbsp;####&nbsp;#&nbsp;##&nbsp;##&nbsp;#/#(##,###)&nbsp;###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;ls_stable-row&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;ls_stable-col&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;call&nbsp;method&nbsp;gc_grid-&gt;refresh_table_display&nbsp;"&nbsp;gc_grid&nbsp;####&nbsp;#&nbsp;refresh###&nbsp;#####&nbsp;###&nbsp;-&gt;#&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;=&nbsp;ls_stable.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_HANDLER_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_handler_toolbar  using    p_object type ref to cl_alv_event_toolbar_set<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_interactive.<br />
&nbsp;&nbsp;"&nbsp;toolbar&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;e_object&nbsp;type&nbsp;cl_alv_event_toolbar_set<br />
&nbsp;&nbsp;"&nbsp;cl_alv_event_toolbar_set&nbsp;-&gt;&nbsp;mt_toolbar&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;mt_toolbar&nbsp;-&gt;&nbsp;ttb_button<br />
&nbsp;&nbsp;"&nbsp;ttb_button&nbsp;-&gt;&nbsp;stb_button&nbsp;####&nbsp;toolbar&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;ls_toolbar&nbsp;type&nbsp;stb_button.&nbsp;"&nbsp;p_object-&gt;mt_toolbar#&nbsp;##&nbsp;###&nbsp;stb_button<br />
&nbsp;&nbsp;ls_toolbar-function&nbsp;=&nbsp;'TEXT'.&nbsp;"&nbsp;##)&nbsp;##&nbsp;###&nbsp;(ok_code##&nbsp;#####&nbsp;###)<br />
&nbsp;&nbsp;ls_toolbar-icon&nbsp;=&nbsp;icon_checked.&nbsp;"&nbsp;##)&nbsp;###<br />
&nbsp;&nbsp;ls_toolbar-quickinfo&nbsp;=&nbsp;'INFORMATION'.&nbsp;"&nbsp;##)&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;append&nbsp;ls_toolbar&nbsp;to&nbsp;p_object-&gt;mt_toolbar.&nbsp;"&nbsp;##&nbsp;####&nbsp;##<br />
<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CLASS_EVENT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form class_event .<br />
&nbsp;&nbsp;"&nbsp;register_edit&nbsp;:&nbsp;screen#&nbsp;itab&nbsp;###<br />
&nbsp;&nbsp;call&nbsp;method&nbsp;gc_grid-&gt;register_edit_event<br />
&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_event_id&nbsp;=&nbsp;cl_gui_alv_grid=&gt;mc_evt_modified.&nbsp;"&nbsp;###,enter,tab#&nbsp;##&nbsp;###&nbsp;data_changed&nbsp;event##<br />
&nbsp;&nbsp;create&nbsp;object&nbsp;go_event.&nbsp;"&nbsp;###&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;set&nbsp;handler&nbsp;go_event-&gt;handler_toolbar&nbsp;for&nbsp;gc_grid.&nbsp;"&nbsp;##&nbsp;##&nbsp;#&nbsp;###&nbsp;####&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;set&nbsp;handler&nbsp;go_event-&gt;handler_user_command&nbsp;for&nbsp;gc_grid.&nbsp;"&nbsp;##&nbsp;##&nbsp;#&nbsp;###&nbsp;####&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;set&nbsp;handler&nbsp;go_event-&gt;handler_data_changed&nbsp;for&nbsp;gc_grid.&nbsp;"&nbsp;ztel&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;set&nbsp;handler&nbsp;go_event-&gt;handler_data_changed_finished&nbsp;for&nbsp;gc_grid.&nbsp;"&nbsp;###&nbsp;ztel&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;##)&nbsp;data_changed#&nbsp;data_changed_finished#&nbsp;##(##)##&nbsp;#####&nbsp;#&nbsp;###<br />
&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;####&nbsp;###,&nbsp;###&nbsp;#####&nbsp;#####&nbsp;###&nbsp;#####&nbsp;####<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_HANDER_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_hander_user_command  using    p_ucomm.<br />
&nbsp;&nbsp;case&nbsp;p_ucomm.<br />
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;'TEXT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;message&nbsp;'##########'&nbsp;type&nbsp;'I'.<br />
&nbsp;&nbsp;endcase.<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_HANDLER_DATA_CHANGD<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_handler_data_changed  using   p_data_changed type ref to cl_alv_changed_data_protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_onf4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_onf4_before<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_onf4_after<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p_ucomm.<br />
&nbsp;&nbsp;"&nbsp;cl_alv_changed_data_protocol&nbsp;=&gt;&nbsp;mt_good_cells<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;cl_alv_changed_data_protocol:&nbsp;&nbsp;cl_gui_alv_grid&nbsp;#####&nbsp;data_changed&nbsp;#####&nbsp;er_data_changed&nbsp;#####&nbsp;associated&nbsp;type<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;mt_good_cells":&nbsp;er_data_changed#&nbsp;attributes&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;gt_good_cells&nbsp;type&nbsp;lvc_t_modi<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;mt_good_cells&nbsp;##&nbsp;LVC_T_MODI&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;lvc_t_modi&nbsp;type&nbsp;lvc_s_modi<br />
&nbsp;&nbsp;"&nbsp;lvc_s_modi=&gt;fieldname&nbsp;(####),&nbsp;row_id&nbsp;(#####),&nbsp;value&nbsp;(###)<br />
<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;ls_modi&nbsp;type&nbsp;lvc_s_modi.<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;lv_len(02).<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"&nbsp;##&nbsp;1<br />
*&nbsp;&nbsp;clear&nbsp;:&nbsp;ls_modi,&nbsp;lv_len.<br />
*&nbsp;&nbsp;loop&nbsp;at&nbsp;p_data_changed-&gt;mt_good_cells&nbsp;into&nbsp;ls_modi.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ls_modi-fieldname&nbsp;=&nbsp;'ZTEL'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_student&nbsp;into&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ls_modi-value&nbsp;is&nbsp;initial.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_student-zcolor&nbsp;=&nbsp;icon_led_red.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;=&nbsp;strlen(&nbsp;ls_modi-value&nbsp;).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_len&nbsp;=&nbsp;'11'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_student-zcolor&nbsp;=&nbsp;icon_led_green.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_student-zcolor&nbsp;=&nbsp;icon_led_yellow.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_student&nbsp;from&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;gs_student.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
*&nbsp;&nbsp;endloop.<br />
*<br />
*&nbsp;&nbsp;perform&nbsp;refresh.<br />
<br />
*&nbsp;&nbsp;"&nbsp;##&nbsp;2<br />
*&nbsp;&nbsp;loop&nbsp;at&nbsp;p_data_changed-&gt;mt_good_cells&nbsp;into&nbsp;ls_modi.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ls_modi-fieldname&nbsp;=&nbsp;'ZTEL'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;gs_student.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_student&nbsp;into&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ls_modi-value&nbsp;is&nbsp;initial.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;p_data_changed-&gt;modify_cell<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_modi-row_id<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'ZCOLOR'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;icon_led_red.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;=&nbsp;strlen(&nbsp;ls_modi-value&nbsp;).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_len&nbsp;=&nbsp;'11'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;p_data_changed-&gt;modify_cell<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_modi-row_id<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'ZCOLOR'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;=&nbsp;icon_led_green.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;method&nbsp;p_data_changed-&gt;modify_cell<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exporting<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_row_id&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_modi-row_id<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_fieldname&nbsp;=&nbsp;'ZCOLOR'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_value&nbsp;=&nbsp;icon_led_yellow.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_student&nbsp;from&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;gs_student.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
*&nbsp;&nbsp;endloop.<br />
*&nbsp;&nbsp;perform&nbsp;refresh.<br />
<br />
   </div>
   <div class="code">
" ## 3<br />
loop at p_data_changed-&gt;mt_good_cells into ls_modi.<br />
&nbsp;&nbsp;if&nbsp;ls_modi-fieldname&nbsp;=&nbsp;'ZTEL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_student&nbsp;into&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ls_modi-value&nbsp;is&nbsp;initial.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_student-zcolor&nbsp;=&nbsp;icon_led_red.<br />
&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lv_len&nbsp;=&nbsp;strlen(&nbsp;ls_modi-value&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;lv_len&nbsp;=&nbsp;'11'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_student-zcolor&nbsp;=&nbsp;icon_led_green.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_student-zcolor&nbsp;=&nbsp;icon_led_yellow.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;modify&nbsp;gt_student&nbsp;from&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;gs_student.<br />
&nbsp;&nbsp;endif.<br />
endloop.<br />
call method cl_gui_cfw=&gt;set_new_ok_code<br />
&nbsp;&nbsp;exporting<br />
&nbsp;&nbsp;&nbsp;&nbsp;new_code&nbsp;=&nbsp;'OK'.<br />
<br />
<br />
<br />
endform.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;ALV_DATA_CHANGED_FINISHED<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
form alv_data_changed_finished  using    p_modified<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pt_good_cells&nbsp;type&nbsp;lvc_t_modi.<br />
&nbsp;&nbsp;"&nbsp;mt_good&nbsp;cells&nbsp;type&nbsp;lvc_t_modi<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;pt_good_cells&nbsp;:&nbsp;###&nbsp;###&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;fieldname:&nbsp;###&nbsp;###<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;row_id&nbsp;:&nbsp;###&nbsp;#&nbsp;##&nbsp;(alv&nbsp;##&nbsp;###)<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;value&nbsp;:&nbsp;####&nbsp;###&nbsp;##&nbsp;#<br />
&nbsp;&nbsp;"&nbsp;lvc_t_modi&nbsp;type&nbsp;lvc_s_modi<br />
&nbsp;&nbsp;"&nbsp;-&nbsp;p_modified:&nbsp;'X'##&nbsp;###&nbsp;###&nbsp;##&nbsp;####&nbsp;##&nbsp;(###&nbsp;####&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;)<br />
&nbsp;&nbsp;"&nbsp;lvc_s_modi=&gt;fieldname(####),&nbsp;row_id(#####),&nbsp;value(###)<br />
&nbsp;&nbsp;data&nbsp;:&nbsp;ls_modi&nbsp;type&nbsp;lvc_s_modi.<br />
&nbsp;&nbsp;clear&nbsp;:&nbsp;ls_modi.<br />
&nbsp;&nbsp;loop&nbsp;at&nbsp;pt_good_cells&nbsp;into&nbsp;ls_modi.<br />
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;ls_modi-fieldname&nbsp;=&nbsp;'ZTEL'.&nbsp;"&nbsp;####&nbsp;##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;read&nbsp;table&nbsp;gt_student&nbsp;into&nbsp;gs_student&nbsp;index&nbsp;ls_modi-row_id.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;gs_student-zcolor&nbsp;ne&nbsp;icon_led_green.&nbsp;"&nbsp;###&nbsp;##&nbsp;-&gt;&nbsp;green&nbsp;###&nbsp;##&nbsp;X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;table&nbsp;gt_student&nbsp;from&nbsp;gs_student.&nbsp;"&nbsp;####&nbsp;##&nbsp;##&nbsp;##&nbsp;####&nbsp;##&nbsp;##&nbsp;##&nbsp;#####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clear&nbsp;gs_student.<br />
&nbsp;&nbsp;&nbsp;&nbsp;endif.<br />
&nbsp;&nbsp;endloop.<br />
&nbsp;&nbsp;perform&nbsp;refresh.<br />
endform.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750</td>
   </tr>
</table>
</body>
</html>
